<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Supaku Interactive — Publisher Hub (Prototype)</title>
  <style>
    :root{
      --bg:#0b0b0d;
      --panel:#0f1113;
      --muted:#9aa3ad;
      --accent:#00ffd1;
      --accent-2:#9b6bff;
      --glass: rgba(255,255,255,0.03);
      --radius:14px;
      --ff: 'Inter', system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
    }
    *{box-sizing:border-box}
    body{margin:0; font-family:var(--ff); background:linear-gradient(180deg,#060608 0%, #0b0b0d 100%); color:#e6eef2;}

    /* Top navbar */
    header{position:sticky;top:0;z-index:50;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.00));backdrop-filter:blur(6px);border-bottom:1px solid rgba(255,255,255,0.03)}
    .nav{max-width:1200px;margin:0 auto;display:flex;align-items:center;gap:20px;padding:14px}
    .brand{font-weight:800;font-size:20px;letter-spacing:1px}
    .brand .accent{background:linear-gradient(90deg,var(--accent),var(--accent-2));-webkit-background-clip:text;background-clip:text;color:transparent}
    nav{margin-left:auto}
    nav a{color:var(--muted);text-decoration:none;margin-left:16px;padding:8px 10px;border-radius:10px;transition:transform .18s ease, color .18s ease, box-shadow .18s ease, background-color .18s ease;font-weight:600;position:relative;z-index:1}
    nav a::after{content:"";position:absolute;inset:0;border-radius:10px;box-shadow:0 0 0 rgba(0,0,0,0);transition:box-shadow .18s ease,transform .18s ease;pointer-events:none}
    nav a.active, nav a:hover{color:var(--accent);background:linear-gradient(90deg, rgba(0,255,209,0.06), rgba(155,107,255,0.06));transform:translateY(-3px) scale(1.02)}
    nav a:hover::after{box-shadow:0 10px 30px rgba(0,255,209,0.10),0 0 40px rgba(155,107,255,0.06);transform:scale(1.02)}
    nav a:active{transform:translateY(-1px) scale(0.995)}

    /* container */
    .container{max-width:1200px;margin:26px auto;padding:0 18px}

    /* hero + carousel */
    .hero{display:flex;flex-direction:column;gap:18px}
    .carousel{position:relative;border-radius:var(--radius);overflow:hidden;background:var(--panel);border:1px solid rgba(255,255,255,0.03)}
    .slides{display:flex;transition:transform .5s cubic-bezier(.2,.9,.2,1);}
    .slide{min-width:100%;display:grid;grid-template-columns: 1fr 360px;gap:18px;padding:24px;align-items:center}
    .slide .meta{padding:8px}
    .slide h2{margin:0 0 8px 0;font-size:28px}
    .sub{color:var(--muted);margin-bottom:12px}

    /* Cover containers use explicit aspect-ratio to avoid stretching/cropping issues */
    .cover, .slide .cover, .feature .cover {aspect-ratio:16/9;width:100%;height:auto;background:#111;border-radius:10px;overflow:hidden;display:block}
    .cover img, .card img, .small-card img, .screenshot img, .responsive-img{width:100%;height:100%;object-fit:cover;display:block}

    .cover{box-shadow:0 6px 24px rgba(0,0,0,0.6);color:var(--muted)}
    .carousel .controls{position:absolute;inset:0;pointer-events:none}
    .btn{pointer-events:auto;position:absolute;top:50%;transform:translateY(-50%);background:var(--glass);border:1px solid rgba(255,255,255,0.04);padding:10px;border-radius:12px;cursor:pointer;transition:transform .18s ease, box-shadow .18s ease, background-color .18s ease}
    .btn.left{left:12px}
    .btn.right{right:12px}
    .btn:hover{transform:translateY(-52%) scale(1.04);box-shadow:0 8px 30px rgba(0,255,209,0.12),0 0 24px rgba(155,107,255,0.06)}
    .btn:active{transform:translateY(-50%) scale(0.98)}

    /* dots indicators */
    .dots{position:absolute;left:50%;transform:translateX(-50%);bottom:12px;display:flex;gap:8px;z-index:20}
    .dot{width:12px;height:12px;border-radius:50%;background:rgba(255,255,255,0.06);border:1px solid rgba(255,255,255,0.04);cursor:pointer;transition:transform .18s cubic-bezier(.2,.9,.2,1),box-shadow .18s ease,background .18s ease}
    .dot[aria-current="true"]{background:linear-gradient(90deg,var(--accent),var(--accent-2));box-shadow:0 8px 30px rgba(0,255,209,0.12),0 0 24px rgba(155,107,255,0.08);transform:scale(1.18)}
    .dot:focus{outline:2px solid rgba(0,255,209,0.12);outline-offset:4px}

    /* home grid: two-column layout where items can span both columns */
    .home-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:18px;margin-top:18px;align-items:start}

    /* large feature: spans both columns and contains image + meta */
    .feature{grid-column:1 / -1;display:grid;grid-template-columns:1fr 420px;gap:18px;align-items:center;padding:16px;border-radius:var(--radius);background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));border:1px solid rgba(255,255,255,0.03)}
    .feature--reverse{grid-template-columns:420px 1fr}
    .feature .meta h3{margin:0 0 6px 0}
    .feature .meta p{margin:0}

    /* studio link under meta */
    .studio-link{display:inline-block;margin-top:6px;padding:6px 10px;border-radius:10px;background:rgba(0,0,0,0.12);color:var(--muted);font-size:13px;text-decoration:none}
    .studio-link:hover{color:var(--accent);transform:translateY(-3px)}

    /* small card: occupies one column in the grid */
    .small-card{display:flex;gap:12px;align-items:center;padding:12px;border-radius:12px;background:rgba(0,0,0,0.06);border:1px solid rgba(255,255,255,0.02)}
    .small-card img{width:140px;aspect-ratio:16/9;object-fit:cover;border-radius:8px}
    .small-card .meta{font-size:14px}

    /* social buttons */
    .socials{display:flex;gap:8px;margin-top:8px}
    .social-btn{padding:8px 10px;border-radius:10px;background:rgba(255,255,255,0.03);color:var(--muted);font-weight:600;text-decoration:none;transition:transform .14s ease,box-shadow .14s ease}
    .social-btn:hover{transform:translateY(-4px);box-shadow:0 12px 30px rgba(0,255,209,0.06)}

    /* grid fallback for games listing page */
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:18px;margin-top:6px}
    .card{background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));padding:14px;border-radius:var(--radius);border:1px solid rgba(255,255,255,0.03)}
    .card img{width:100%;aspect-ratio:16/9;object-fit:cover;border-radius:10px}
    .card h3{margin:10px 0 6px 0}
    .pill{display:inline-block;padding:6px 8px;border-radius:999px;background:rgba(0,0,0,0.25);color:var(--muted);font-size:13px;position:relative;overflow:visible;transition:transform .14s ease, box-shadow .14s ease}
    .pill::after{content:"";position:absolute;inset:-6px;border-radius:999px;filter:blur(10px);opacity:0;transition:opacity .18s ease}
    .pill:hover{transform:translateY(-4px)}
    .pill:hover::after{opacity:0.28;background:linear-gradient(90deg,var(--accent),var(--accent-2));}

    .cta{display:inline-block;margin-top:8px;padding:8px 12px;border-radius:12px;background:linear-gradient(90deg,var(--accent),var(--accent-2));color:#061018;font-weight:700;text-decoration:none;position:relative;overflow:visible;transition:transform .18s cubic-bezier(.2,.9,.2,1),box-shadow .18s ease,filter .18s ease}
    .cta::after{content:"";position:absolute;left:50%;top:50%;transform:translate(-50%,-50%) scale(0.98);width:120%;height:100%;border-radius:12px;background:linear-gradient(90deg,var(--accent),var(--accent-2));filter:blur(18px);opacity:0;transition:opacity .18s ease,transform .18s ease;pointer-events:none;z-index:-1}
    .cta:hover{transform:translateY(-4px) scale(1.03);box-shadow:0 12px 40px rgba(0,255,209,0.12),0 0 30px rgba(155,107,255,0.07);filter:brightness(1.03)}
    .cta:hover::after{opacity:0.32;transform:translate(-50%,-50%) scale(1.06)}
    .cta:active{transform:translateY(-2px) scale(0.995);box-shadow:0 8px 30px rgba(0,0,0,0.25)}
    .cta:focus{outline:2px solid rgba(0,255,209,0.12);outline-offset:4px}

    /* detail templates */
    .detail{display:grid;grid-template-columns:1fr 360px;gap:22px}
    .detail .gallery{display:flex;flex-direction:column;gap:12px}
    .screenshot{aspect-ratio:16/9;background:#0b0d10;border-radius:10px;display:flex;align-items:center;justify-content:center;color:var(--muted);overflow:hidden}
    .embed-trailer{width:100%;height:200px;border-radius:10px;border:1px solid rgba(255,255,255,0.04);overflow:hidden}

    /* studios */
    .studio-list{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:16px}
    .studio-card{padding:12px;border-radius:12px;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));border:1px solid rgba(255,255,255,0.03)}

    /* tiny animations */
    .fade-in{opacity:0;transform:translateY(6px);animation:fadeIn .6s forwards}
    @keyframes fadeIn{to{opacity:1;transform:none}}

    /* responsive tweaks */
    @media (max-width:1100px){
      .home-grid{grid-template-columns:1fr}
      .feature{grid-template-columns:1fr}
      .feature--reverse{grid-template-columns:1fr}
      .cover{aspect-ratio:16/9}
      .dots{bottom:8px}
    }

    /* footer */
    footer{max-width:1200px;margin:32px auto;padding:24px;color:var(--muted)}

    .muted{color:var(--muted)}
  </style>
</head>
<body>
  <header>
    <div class="nav">
      <div class="brand">Supaku <span class ="accent">Interactive</span></div>
      <nav>
        <a href="#" data-page="home" class="active">Home</a>
        <a href="#" data-page="games">Games</a>
        <a href="#" data-page="studios">Studios</a>
        <a href="#" data-page="about">About</a>
        <a href="#" data-page="devs">For Developers</a>
      </nav>
    </div>
  </header>

  <main class="container">

    <!-- HOME -->
    <section id="home" data-section>
      <div class="hero">
        <div class="carousel" id="carousel">
          <div class="slides" id="slides"></div>
          <div class="controls">
            <button class="btn left" id="prev" aria-label="Previous">◀</button>
            <button class="btn right" id="next" aria-label="Next">▶</button>
          </div>
          <div class="dots" id="dots" role="tablist" aria-label="Carousel indicators"></div>
        </div>

        <h1 class="section-title">We are Supaku Interactive</h1>
        <p class="muted" style="margin-top: -30px;">A publisher that tries to support small indie titels, some you have never seen or heard of!</p>
        <h3 style="margin-top: -20px;">Transparency</h3>
        <p class="muted"style="margin-top: -30px;">We want to be as much transparent as we are comfortable with, to see our publisher policy click on for developers!</p>

        <!-- Grid: large features span two columns, small cards occupy one column -->
        <div class="home-grid" id="homeGrid"></div>

      </div>
    </section>

    <!-- GAMES LIST -->
    <section id="games" data-section style="display:none">
      <h1 class="section-title">All Games</h1>
      <div class="grid" id="gamesGrid"></div>
    </section>

    <!-- STUDIOS -->
    <section id="studios" data-section style="display:none">
      <h1 class="section-title">Studios</h1>
      <div class="studio-list" id="studioList"></div>
    </section>

    <!-- ABOUT -->
    <section id="about" data-section style="display:none">
      <h1 class="section-title">About Supaku Interactive</h1>
      <p class="muted">Supaku Interactive is an open publisher hub for indie developers. We help small teams with visibility, community features and a shared platform — without taking revenue shares. This prototype is a pilot — contact us for more information.</p>
    </section>

    <!-- FOR DEVELOPERS -->
    <section id="devs" data-section style="display:none">
      <h1 class="section-title">For Developers</h1>
      <h3>A publisher from an Indie Dev, for Indie Devs</h3>
      <div style="display:grid;grid-template-columns:1fr 320px;gap:18px">
        <div>
          <h3>What we offer</h3>
          <ul class="muted">
            <li><b>You keep everything, no revenue share!</b></li>
            <li>Curated listings & publisher brand</li>
            <li>Social sharing, youtube game trailers, promotions</li>
            <li>Community hub (Discord) with events & cross-promotions</li>
            <li>Low entry barrier especially during pilot</li>
            <li>Possibility to leave until the game is released (normal or early access)</li>
          </ul>

          <h3 style="margin-top:14px">Our dependencies</h3>
          <ul class="muted">
            <li>Working demo for review (this demo does not have to be public) except if otherwise discussed</li>
            <li>Regular dev updates (min 1 per month)</li>
            <li>Agreement to list Supaku as publisher</li>
            <li>Game Screenshots, Title, Title Picture and General Information</li>
            <li>We take absolutely no responsability for your game!</li>
            <li>No NSFW content!</li>
            <li>We get to kick you out of the program at any time if we have concerns about you, the game or any other aspect!</li>
          </ul>
        </div>
        <aside style="padding:12px;background:var(--panel);border-radius:12px;border:1px solid rgba(255,255,255,0.03)">
          <strong>Quick overview</strong>
          <p class="muted" style="font-size:14px">You keep 100% revenue. We offer visibility in exchange for a small marketing commitment.</p>
          <strong>You think that you fit?</strong>
          <a class="cta" href="https://forms.gle/rjN58uoZM2DckCna9" target="_blank">Apply (Google Form)</a>
          <br>
          <br>
          <strong>Any Questions</strong>
          <br>
          <a class="cta" href="#">* missing</a>
        </aside>
      </div>
      <h3>Whats the idea behind all of this</h3>
        <p>The more games we get together, the more players will come to our platform and discover other games. Its basically a rolling stone effect type of studio. Players that like your game come to our platfrom and discover other games and studios. And all of this vise versa!</p>
        <h3>Well, whats the catch</h3>
        <p>Short answer, ther is <strong>no</strong> catch!</p>
        <h3>Ok, how does Supaku Interactive profit from this</h3>
        <p>We get to build up a huge community and that way support games of our partner studio <strong>MaixenStudios</strong>. We hereby promise though that this studio is treated like any other studio of Supaku Interactive!</p>
    </section>

    <!-- GAME DETAIL TEMPLATE -->
    <section id="gameDetail" data-section style="display:none">
      <a class="cta" id="backToList" style="margin-bottom:12px;display:inline-block">← Back</a>
      <div class="detail">
        <div>
          <h2 id="g-title">Game Title</h2>
          <p id="g-desc" class="muted">Short description of the game.</p>
          <div style="margin-top:12px">
            <a class="cta" id="g-store" href="#" target="_blank" rel="noopener">Visit Store</a>
            <a class="studio-link" id="g-studio-link" href="#">View Studio</a>
          </div>
        </div>
        <div class="gallery">
          <div id="g-cover" class="screenshot">Cover</div>
          <div id="g-screens" style="display:flex;gap:8px;flex-wrap:wrap"></div>
          <div id="g-trailer" class="embed-trailer">Trailer (iframe)</div>
        </div>
      </div>
    </section>

    <!-- STUDIO DETAIL TEMPLATE -->
    <section id="studioDetail" data-section style="display:none">
      <a class="cta" id="backToStudios" style="margin-bottom:12px;display:inline-block">← Back</a>
      <div class="detail">
        <div>
          <h2 id="s-name">Studio Name</h2>
          <p id="s-desc" class="muted">Short description here</p>
          <p id="s-long" class="muted" style="margin-top:8px"></p>
          <div class="socials" id="s-socials"></div>
        </div>
        <div class="gallery" id="s-games"></div>
      </div>
    </section>

  </main>

  <footer>
    <div class="container muted">© Supaku Interactive 2025 - All rights reserved. Prototype/Pilot-Phase.</div>
  </footer>

  <script>
    /**
     * Fixes for image display:
     * - rely on CSS aspect-ratio (16:9) for all covers / cards / screenshots
     * - use classes (responsive-img / thumb-img via CSS) and remove inline height overrides
     * - small cards show Details first (already implemented) and thumbnails use aspect-ratio
     */

    const AUTOPLAY_DELAY = 5000; // ms
    let autoplayTimer = null;

    const DATA = {
      games: [
        { id: 'isoforge', title: 'Isoforge', sub: 'A city builder with tower defense mechanics', desc: 'A city builder the new wa! Combine buildings the right way to get bonuses, watch out for your resources and defend your island...', cover: 'isoforge-c.png', screenshots: ['ss1.jpg','ss2.jpg'], trailer: '', studio: 'maixenstudios', layout: 'right', store: 'https://store.example.com/loafing-town' },
        { id: 'default-game', title: 'Your Game', sub: 'This could be your game', desc: 'A nice, beautiful game made by you...', cover: 'cover1.jpg', screenshots: ['ss1.jpg','ss2.jpg'], trailer: '', studio: 'default', layout: 'left', store: 'https://store.example.com/loafing-town' },
      ],
      studios: [
        { id:'maixenstudios', name:'MaixenStudios', desc:'Small indie studio focusing on creating unique experiences.', long_desc: 'We are a small indie studio founded in 202 by Maixen. After creating a lot of small demos, projects and game jam games we made our first big commercial project: Isoforge', twitter: '', website: '', discord: 'https://discord.gg/zDrCbxwQhD', youtube: 'https://www.youtube.com/@maixenstudios' },
        { id:'deafault', name:'Your Studios', desc:'This could be your Studio!', long_desc: 'This could be your Studio!.', twitter: '', website: 'https://google.com', youtube: 'https://youtube.com/' }
      ]
    }

    // SPA navigation
    const links = document.querySelectorAll('nav a');
    links.forEach(a=>a.addEventListener('click', (e)=>{
      e.preventDefault();
      const page = a.dataset.page;
      showSection(page);
      links.forEach(x=>x.classList.toggle('active', x===a));
      resetAutoplay();
    }))
    function showSection(name){
      document.querySelectorAll('[data-section]').forEach(s=>s.style.display='none');
      const el = document.getElementById(name);
      if(el) el.style.display = 'block';
      window.scrollTo({top:0,behavior:'smooth'});
    }

    // Elements
    const slidesEl = document.getElementById('slides');
    const homeGrid = document.getElementById('homeGrid');
    const gamesGrid = document.getElementById('gamesGrid');
    const studioList = document.getElementById('studioList');
    const carouselEl = document.getElementById('carousel');
    const dotsEl = document.getElementById('dots');

    // helper: build paths for variants from a cover filename or path
    function pathsFor(file){
      const fname = file.includes('/') ? file.split('/').pop() : file;
      return {
        original: `assets/originals/${fname}`,
        large: `assets/large/${fname}`,
        medium: `assets/medium/${fname}`,
        thumb: `assets/thumbs/${fname}`
      }
    }

    function render(){
      slidesEl.innerHTML = '';
      homeGrid.innerHTML = '';
      gamesGrid.innerHTML = '';
      studioList.innerHTML = '';
      dotsEl.innerHTML = '';

      // Carousel slides (use medium/large with srcset)
      DATA.games.forEach((g, idx)=>{
        const p = pathsFor(g.cover);
        const slide = document.createElement('div'); slide.className='slide fade-in';
        slide.setAttribute('role','group');
        slide.setAttribute('aria-roledescription','Slide');
        slide.setAttribute('aria-label', `${idx+1} of ${DATA.games.length}`);
        slide.innerHTML = `
          <div class="meta">
            <h2>${g.title}</h2>
            <div class="sub">${g.sub}</div>
            <p class="muted">${g.desc}</p>
            <div style="margin-top:12px">
              <a class="cta" href="#" data-game="${g.id}">Details</a>
              <a class="pill" href="${g.store || '#'}" target="_blank" rel="noopener">Store</a>
              <a class="studio-link" href="#" data-studio="${g.studio}">Studio</a>
            </div>
          </div>
          <div class="cover"><img class="responsive-img"
            src="${p.medium}"
            srcset="${p.medium} 800w, ${p.large} 1600w"
            sizes="(max-width:1100px) 100vw, 420px"
            loading="lazy" decoding="async" alt="${g.title}"></div>
        `;
        slidesEl.appendChild(slide);

        // create dot for this slide
        const dot = document.createElement('button');
        dot.className = 'dot';
        dot.type = 'button';
        dot.setAttribute('aria-label', `Slide ${idx+1}`);
        dot.setAttribute('role','tab');
        dot.dataset.index = idx;
        dot.addEventListener('click', (e)=>{ idx = Number(e.currentTarget.dataset.index); updateCarousel(); resetAutoplay(); });
        dotsEl.appendChild(dot);
      })

      // Build home grid: two-column grid where features span both columns
      let autoSide = 'left';
      DATA.games.forEach(g=>{
        const p = pathsFor(g.cover);
        if(g.layout === 'small'){
          const sc = document.createElement('div'); sc.className='small-card fade-in';
          sc.innerHTML = `<img class="thumb-img" src="${p.thumb}" loading="lazy" decoding="async" alt="${g.title}"><div class="meta"><strong>${g.title}</strong><div class="muted">${g.sub}</div><div style="margin-top:6px"><a class="pill" href="#" data-game="${g.id}">Details</a> <a class="pill" href="${g.store||'#'}" target="_blank">Store</a> <a class="studio-link" href="#" data-studio="${g.studio}">Studio</a></div></div>`;
          homeGrid.appendChild(sc);
          return;
        }

        // large feature
        const feature = document.createElement('div'); feature.className='feature fade-in';
        const side = g.layout ? g.layout : autoSide;
        if(side === 'right') feature.classList.add('feature--reverse');
        feature.innerHTML = `
          <div class="meta"><h3>${g.title}</h3><div class="muted">${g.sub}</div><p class="muted" style="margin-top:8px">${g.desc}</p><div style="margin-top:12px"><a class="cta" href="#" data-game="${g.id}">Details</a> <a class="pill" href="${g.store||'#'}" target="_blank">Store</a> <a class="studio-link" href="#" data-studio="${g.studio}">Studio</a></div></div>
          <div class="cover"><img class="responsive-img" src="${p.medium}" srcset="${p.medium} 800w, ${p.large} 1600w" sizes="(max-width:1100px) 100vw, 420px" loading="lazy" decoding="async" alt="${g.title}"></div>
        `;
        homeGrid.appendChild(feature);
        autoSide = (autoSide === 'left') ? 'right' : 'left';
      })

      // games page grid
      DATA.games.forEach(g=>{
        const p = pathsFor(g.cover);
        const card = document.createElement('article'); card.className='card fade-in';
        card.innerHTML = `<img class="responsive-img" src="${p.medium}" srcset="${p.medium} 800w, ${p.large} 1600w" sizes="(max-width:1100px) 100vw, 420px" loading="lazy" decoding="async" alt="${g.title}"><h3>${g.title}</h3><div class="sub">${g.sub}</div><div style="margin-top:8px"><a class="cta" href="#" data-game="${g.id}">Details</a> <a class="pill" href="${g.store||'#'}" target="_blank">Store</a></div>`;
        gamesGrid.appendChild(card);
      })

      // studios
      DATA.studios.forEach(s=>{
        const sc = document.createElement('div'); sc.className='studio-card fade-in';
        sc.innerHTML = `<h3>${s.name}</h3><p class="muted">${s.desc}</p><div style="margin-top:8px"><a class="pill" href="#" data-studio="${s.id}">More</a></div>`;
        studioList.appendChild(sc);
      })

      attachListeners();
      updateActiveDot();
    }

    // listeners are added after render so they always bind to fresh elements
    function attachListeners(){
      // game links -> open detail
      document.querySelectorAll('[data-game]').forEach(a=>{
        a.addEventListener('click', (e)=>{
          e.preventDefault(); openGame(a.dataset.game); resetAutoplay();
        })
      });
      // studio links -> open studio
      document.querySelectorAll('[data-studio]').forEach(a=>{
        a.addEventListener('click', (e)=>{
          e.preventDefault(); openStudio(a.dataset.studio); resetAutoplay();
        })
      });

      // dots keyboard support: left/right arrows
      dotsEl.querySelectorAll('.dot').forEach(d=>{
        d.addEventListener('keydown', (e)=>{
          if(e.key === 'ArrowLeft') { prevSlide(); resetAutoplay(); d.previousElementSibling?.focus(); }
          if(e.key === 'ArrowRight') { nextSlide(); resetAutoplay(); d.nextElementSibling?.focus(); }
        });
      });
    }

    // carousel controls
    let idx = 0;
    function updateCarousel(){
      const w = document.querySelector('.carousel').clientWidth;
      document.getElementById('slides').style.transform = `translateX(${-idx * w}px)`;
      updateActiveDot();
    }

    function updateActiveDot(){
      const dots = dotsEl.querySelectorAll('.dot');
      dots.forEach((d,i)=>{
        const isActive = i === idx;
        d.setAttribute('aria-current', isActive ? 'true' : 'false');
        if(isActive) d.classList.add('active'); else d.classList.remove('active');
      });
    }

    function nextSlide(){ idx = (idx+1) % DATA.games.length; updateCarousel(); }
    function prevSlide(){ idx = (idx-1+DATA.games.length) % DATA.games.length; updateCarousel(); }

    document.getElementById('prev').addEventListener('click', ()=>{ prevSlide(); resetAutoplay(); });
    document.getElementById('next').addEventListener('click', ()=>{ nextSlide(); resetAutoplay(); });

    // autoplay control
    function startAutoplay(){ stopAutoplay(); autoplayTimer = setInterval(()=>{ nextSlide(); }, AUTOPLAY_DELAY); }
    function stopAutoplay(){ if(autoplayTimer) clearInterval(autoplayTimer); autoplayTimer = null; }
    function resetAutoplay(){ stopAutoplay(); startAutoplay(); }

    // pause on hover
    carouselEl.addEventListener('mouseenter', ()=>{ stopAutoplay(); });
    carouselEl.addEventListener('mouseleave', ()=>{ startAutoplay(); });

    // open detail
    function openGame(id){
      const game = DATA.games.find(x=>x.id===id); if(!game) return;
      showSection('gameDetail');
      document.getElementById('g-title').textContent = game.title;
      document.getElementById('g-desc').textContent = game.desc;
      document.getElementById('g-store').href = game.store || '#';
      document.getElementById('g-store').target = '_blank';
      // studio link in game detail
      const studioObj = DATA.studios.find(s=>s.id === game.studio);
      if(studioObj){
        document.getElementById('g-studio-link').textContent = studioObj.name;
        document.getElementById('g-studio-link').dataset.studio = studioObj.id;
        document.getElementById('g-studio-link').href = '#';
      } else {
        document.getElementById('g-studio-link').textContent = 'Studio';
        document.getElementById('g-studio-link').removeAttribute('data-studio');
        document.getElementById('g-studio-link').href = '#';
      }

      const p = pathsFor(game.cover);
      document.getElementById('g-cover').innerHTML = `<img class="responsive-img" src="${p.large}" srcset="${p.medium} 800w, ${p.large} 1600w" sizes="(max-width:1100px) 100vw, 420px" alt="${game.title}">`;
      const ss = document.getElementById('g-screens'); ss.innerHTML='';
      (game.screenshots||[]).forEach(s=>{ const sp = pathsFor(s); const d=document.createElement('div'); d.className='screenshot'; d.innerHTML = `<img class="responsive-img" src="${sp.medium}" srcset="${sp.medium} 800w, ${sp.large} 1600w" sizes="(max-width:1100px) 100vw, 320px" alt="${game.title}">`; ss.appendChild(d); });
      document.getElementById('g-trailer').innerHTML = game.trailer? `<iframe src="${game.trailer}" frameborder="0" style="width:100%;height:100%"></iframe>` : '<span class="muted" style="padding:14px;display:block">No trailer available</span>';

      // attach studio link listener inside detail
      document.getElementById('g-studio-link').addEventListener('click', (e)=>{ e.preventDefault(); const sid = e.currentTarget.dataset.studio; if(sid) openStudio(sid); resetAutoplay(); });
    }

    document.getElementById('backToList').addEventListener('click', (e)=>{ e.preventDefault(); showSection('home'); resetAutoplay(); });

    function openStudio(id){
      const s = DATA.studios.find(x=>x.id===id); if(!s) return;
      showSection('studioDetail');
      document.getElementById('s-name').textContent = s.name;
      document.getElementById('s-desc').textContent = s.desc;
      document.getElementById('s-long').textContent = s.long_desc || '';

      // socials
      const soc = document.getElementById('s-socials'); soc.innerHTML = '';
      ['website','twitter','discord','youtube'].forEach(k=>{
        if(s[k]){
          const a = document.createElement('a'); a.className='social-btn'; a.href = s[k]; a.target = '_blank'; a.rel='noopener';
          a.textContent = k.charAt(0).toUpperCase() + k.slice(1);
          soc.appendChild(a);
        }
      });

      const sg = document.getElementById('s-games'); sg.innerHTML='';
      const games = DATA.games.filter(g=>g.studio===id);
      games.forEach(g=>{
        const p = pathsFor(g.cover);
        const box = document.createElement('div'); box.className='card'; box.style.padding='8px';
        box.innerHTML = `<img class="thumb-img" src="${p.thumb}" loading="lazy" decoding="async" alt="${g.title}"><h4 style="margin:8px 0 0 0">${g.title}</h4><div class="muted" style="font-size:13px">${g.sub}</div><div style="margin-top:8px"><a class="pill" href="#" data-game="${g.id}">Details</a> <a class="pill" href="${g.store||'#'}" target="_blank">Store</a></div>`;
        sg.appendChild(box);
      });

      // attach listeners for the newly created game links on studio page
      document.querySelectorAll('#studioDetail [data-game]').forEach(a=>a.addEventListener('click',(e)=>{ e.preventDefault(); openGame(a.dataset.game); resetAutoplay(); }));
    }
    document.getElementById('backToStudios').addEventListener('click', (e)=>{ e.preventDefault(); showSection('studios'); resetAutoplay(); });

    // init
    render();
    setTimeout(updateCarousel,200);
    startAutoplay();
  </script>
</body>
</html>
